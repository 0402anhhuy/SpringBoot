# 🌱 Thymeleaf

## ✅ 1. Thymeleaf là gì?

- **Thymeleaf** là một **Java template engine** dùng để kết hợp **HTML + dữ liệu từ Java backend**.

---

## ✅ 2. CÁCH CẤU HÌNH

### 📦 Thêm dependency trong `pom.xml`

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-thymeleaf</artifactId>
</dependency>
```

---

## ✅ 3. THƯ MỤC CHỨA FILE VIEW

| Loại file             | Đặt ở đâu                          |
| --------------------- | ---------------------------------- |
| `.html` view          | `src/main/resources/templates/` ✅ |
| `.css`, `.js`, `.img` | `src/main/resources/static/` ✅    |

---

## ✅ 4. CONTROLLER GỬI DỮ LIỆU CHO VIEW

```java
@Controller
public class HomeController {

    @GetMapping("/")
    public String home(Model model) {
        model.addAttribute("name", "SpringMall");
        return "index"; // → trả về templates/index.html
    }
}
```

---

## ✅ 5. CÁC THẺ & THUỘC TÍNH CƠ BẢN CỦA THYMELEAF

| Thuộc tính           | Tác dụng                | Ví dụ                                                     |
| -------------------- | ----------------------- | --------------------------------------------------------- |
| `th:text`            | Hiển thị nội dung       | `<p th:text="${name}"></p>`                               |
| `th:href`            | Gán link động           | `<a th:href="@{/about}">About</a>`                        |
| `th:src`             | Link ảnh động           | `<img th:src="@{/img/logo.png}">`                         |
| `th:if`, `th:unless` | Rẽ nhánh hiển thị       | `<p th:if="${isAdmin}">Admin</p>`                         |
| `th:each`            | Lặp danh sách           | `<li th:each="p : ${products}" th:text="${p.name}"></li>` |
| `th:value`           | Gán value input         | `<input th:value="${username}"/>`                         |
| `th:object` + `*{}`  | Binding form với object | `<form th:object="${user}"> <input th:field="*{email}"/>` |

---

## ✅ 6. BIỂU THỨC THYMELEAF

| Biểu thức            | Cú pháp               | Ý nghĩa                               |     |                      |
| -------------------- | --------------------- | ------------------------------------- | --- | -------------------- |
| **Variable**         | `${name}`             | Lấy biến từ model                     |     |                      |
| **Selection**        | `*{field}`            | Dùng với `th:object` trong form       |     |                      |
| **Message (i18n)**   | `#{app.title}`        | Lấy chuỗi từ `messages.properties`    |     |                      |
| **URL Link**         | `@{/path}`            | Tạo URL động                          |     |                      |
| **Literal / Format** | \`                    | Hello \${name}                        | \`  | Dễ dàng format chuỗi |
| **Fragment**         | `~{layout :: header}` | Import file HTML khác (giống include) |     |                      |

---

## ✅ 7. DÙNG FORM VỚI THYMELEAF

```java
model.addAttribute("user", new User());
```

```html
<form th:action="@{/register}" th:object="${user}" method="post">
  <input type="text" th:field="*{username}" />
  <input type="password" th:field="*{password}" />
  <button type="submit">Đăng ký</button>
</form>
```

---

## ✅ 8. ĐIỀU KIỆN, LẶP, TOÁN TỬ

```html
<!-- Điều kiện -->
<p th:if="${age >= 18}">Trưởng thành</p>
<p th:unless="${isAdmin}">Bạn không phải admin</p>

<!-- Lặp -->
<ul>
  <li th:each="product : ${products}" th:text="${product.name}"></li>
</ul>

<!-- Ternary -->
<p th:text="${gender == 'M' ? 'Nam' : 'Nữ'}"></p>
```

---

## ✅ 9. LAYOUT VỚI THYMELEAF – DÙNG `fragment`

### 📁 `layout.html` – file gốc

```html
<html>
  <body>
    <div th:fragment="header">Đây là header</div>
    <div th:fragment="footer">Đây là footer</div>
  </body>
</html>
```

### 📄 `home.html` – sử dụng:

```html
<html>
  <body>
    <div th:replace="~{layout :: header}"></div>
    <h1>Trang chủ</h1>
    <div th:replace="~{layout :: footer}"></div>
  </body>
</html>
```

---

## ✅ 10. TƯƠNG TÁC ĐA NGÔN NGỮ (i18n)

### 📁 `messages.properties`

```properties
greeting=Chào bạn
```

### 📁 `messages_en.properties`

```properties
greeting=Hello there
```

### 📄 HTML

```html
<p th:text="#{greeting}"></p>
```

➡️ Sẽ tự đổi theo locale người dùng (nếu cấu hình `LocaleResolver`)

---

## ✅ 11. DỮ LIỆU TỪ CONTROLLER

| Từ Java                   | Sang View                      |
| ------------------------- | ------------------------------ |
| `String name = "Huy"`     | `${name}`                      |
| `User user`               | `${user.username}`, `*{email}` |
| `List<Product> products`  | `th:each="p : ${products}"`    |
| `Map<String, Object> map` | `${map.key}`                   |

---

## ✅ 12. LỖI THƯỜNG GẶP

| Lỗi                   | Nguyên nhân                         |
| --------------------- | ----------------------------------- |
| `Template not found`  | File không nằm đúng `templates/`    |
| Biến `${...}` bị null | Không gán từ `model.addAttribute()` |
| Form không bind được  | Thiếu `th:object`, hoặc `*{}` sai   |
| URL `@{}` bị sai      | Thiếu `{}` hoặc tham số URL         |

---

## ✅ KẾT LUẬN

| Đặc điểm                                    | Lợi ích                     |
| ------------------------------------------- | --------------------------- |
| Được tích hợp sẵn trong Spring Boot         | Không cần cấu hình phức tạp |
| Giao diện HTML dễ viết                      | Không bị phá layout         |
| Tương thích với Form, i18n, layout          | ✔️                          |
| Học một lần, dùng cả đời với Spring Web MVC | 🔥                          |

---

Bạn muốn mình **dựng một mini project Spring Boot dùng Thymeleaf** bao gồm:

- Trang chủ
- Trang form login
- Trang danh sách sản phẩm
- Có layout và fragment

👉 Cứ nói "Dựng Thymeleaf demo", mình tạo luôn đủ controller, HTML, DTO, style... chạy được ngay nhé 🔧🤖
