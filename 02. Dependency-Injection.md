# ğŸŒ± Dependency Injection (DI) trong Spring Boot

**Dependency Injection (DI)** lÃ  má»™t ká»¹ thuáº­t trong láº­p trÃ¬nh giÃºp giáº£m sá»± phá»¥ thuá»™c giá»¯a cÃ¡c thÃ nh pháº§n trong á»©ng dá»¥ng, lÃ m cho mÃ£ dá»… báº£o trÃ¬ vÃ  má»Ÿ rá»™ng hÆ¡n, Ä‘á»ƒ hiá»ƒu rÃµ Ä‘Æ°á»£c cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a DI thÃ¬ chÃºng ta cáº§n tÃ¬m hiá»ƒu hai khÃ¡i niá»‡m dÆ°á»›i Ä‘Ã¢y.

## ğŸ”— `Tight Coupling` (RÃ ng buá»™c cháº·t cháº½)

- Xáº£y ra khi má»™t class phá»¥ thuá»™c máº¡nh vÃ o má»™t class khÃ¡c, lÃ m giáº£m tÃ­nh linh hoáº¡t vÃ  khÃ³ thay Ä‘á»•i.
- Khi yÃªu cáº§u thay Ä‘á»•i logic hay má»™t Class bá»‹ lá»—i sáº½ dáº«n tá»›i áº£nh hÆ°á»Ÿng tá»›i toÃ n bá»™ cÃ¡c Class khÃ¡c.

### ğŸ”¹ VÃ­ dá»¥ vá» `Tight Coupling`:

**`Engine.java`**

```java
public class Engine{
    public void start(){
        System.out.println("Engine is starting...");
    }
}
```

**`Car.java`**

```java
public class Car{
    private Engine engine = new Engine(); // RÃ ng buá»™c cháº·t cháº½

    public void drive(){
        engine.start();
        System.out.println("Car is moving...");
    }
}
```

**`Truck.java`**

```java

public class Truck{
    private Engine engine = new Engine(); // RÃ ng buá»™c cháº·t cháº½

    public void drive(){
        engine.start();
        System.out.println("Truck is moving...");
    }
}
```

### **ğŸ’¡ Váº¥n Ä‘á» `Tight Coupling` náº±m á»Ÿ Ä‘Ã¢u?**

**1ï¸âƒ£ `Car`, `Truck` tá»± táº¡o ra má»™t object `Engine` báº±ng cÃ¡ch new Engine()**

- Äiá»u nÃ y cÃ³ nghÄ©a lÃ  `Car`, `Truck` phá»¥ thuá»™c trá»±c tiáº¿p vÃ o `Engine`.

- Náº¿u chÃºng ta muá»‘n thay Ä‘á»•i Ä‘á»™ng cÆ¡ (vÃ­ dá»¥ `DieselEngine`, `ElectricEngine`), chÃºng ta pháº£i sá»­a code trong Car vÃ  Truck

- Táº¡o Ä‘á»‘i tÆ°á»£ng `Engine` bÃªn trong `Car` vÃ  `Truck` lÃ m cho chÃºng phá»¥ thuá»™c vÃ o má»™t loáº¡i Ä‘á»™ng cÆ¡ cá»¥ thá»ƒ, lÃ m giáº£m tÃ­nh linh hoáº¡t cá»§a há»‡ thá»‘ng.

**2ï¸âƒ£ KhÃ³ má»Ÿ rá»™ng hoáº·c thay Ä‘á»•i sau nÃ y**

- Náº¿u ta cÃ³ má»™t loáº¡i Ä‘á»™ng cÆ¡ má»›i, ta pháº£i sá»­a class `Car`, `Truck` Ä‘á»ƒ thay tháº¿ `Engine`.

- Äiá»u nÃ y lÃ m giáº£m tÃ­nh linh hoáº¡t, vÃ¬ má»—i khi cÃ³ thay Ä‘á»•i, ta pháº£i sá»­a code trong nhiá»u nÆ¡i lÃ m cho code trá»Ÿ nÃªn phá»©c táº¡p hÆ¡n.

## ğŸ”— `Loose Coupling` (RÃ ng buá»™c lá»ng láº»o)

- GiÃºp tÃ¡ch biá»‡t cÃ¡c thÃ nh pháº§n, lÃ m cho há»‡ thá»‘ng dá»… dÃ ng báº£o trÃ¬ vÃ  má»Ÿ rá»™ng báº±ng cÃ¡ch sá»­ dá»¥ng `Dependency Injection (DI)`.

### ğŸ”¹ VÃ­ dá»¥ vá» Loose Coupling:

**`Engine.java`**

```java
public interface Engine{
    void start();
}
```

**`PetroEngine.java`**

```java
public class PetrolEngine implements Engine{
    @Override
    public void start(){
        System.out.println("Petrol Engine is starting...");
    }
}
```

**`DieselEngine.java`**

```java
public class DieselEngine implements Engine{
    @Override
    public void start(){
        System.out.println("Diesel Engine is starting...");
    }
}
```

**`Car.java`**

```java
public class Car{
    private Engine engine;

    // Inject Engine vÃ o Car thÃ´ng qua constructor
    public Car(Engine engine){
        this.engine = engine;
    }

    public void drive(){
        engine.start();
        System.out.println("Car is moving...");
    }
}
```

**`Main.java`**

```java
@SpringBootApplication
public class StoreApplication {
	public static void main(String[] args) {
		SpringApplication.run(StoreApplication.class, args);
        // Táº¡o Ä‘á»™ng cÆ¡ xÄƒng
        Engine petrolEngine = new PetrolEngine();

        // TiÃªm sá»± phá»¥ thuá»™c thá»§ cÃ´ng qua Constructor
        Car myCar = new Car(petrolEngine);
        myCar.drive();

        // Táº¡o Ä‘á»™ng cÆ¡ dáº§u
        Engine dieselEngine = new DieselEngine();

        // TiÃªm sá»± phá»¥ thuá»™c thá»§ cÃ´ng qua Constructor
        Car anotherCar = new Car(dieselEngine);
        anotherCar.drive();
	}
}

```

ğŸ“Œ á» Ä‘Ã¢y, `Car` khÃ´ng cÃ²n phá»¥ thuá»™c trá»±c tiáº¿p vÃ o `PetrolEngine` hay `DieselEngine`, mÃ  chá»‰ phá»¥ thuá»™c vÃ o interface `Engine` vÃ  loáº¡i `Engine` nÃ y Ä‘Æ°á»£c táº¡o trong hÃ m `main`. Äiá»u nÃ y giÃºp dá»… dÃ ng thay Ä‘á»•i loáº¡i Ä‘á»™ng cÆ¡ mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n lá»›p Car.

---

## ğŸ”— `Dependency Injection (DI)`

- Trong DI, cÃ¡c phá»¥ thuá»™c cá»§a má»™t Ä‘á»‘i tÆ°á»£ng khÃ´ng Ä‘Æ°á»£c táº¡o bÃªn trong Ä‘á»‘i tÆ°á»£ng Ä‘Ã³, mÃ  Ä‘Æ°á»£c cung cáº¥p tá»« bÃªn ngoÃ i.

- DI thÆ°á»ng Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua:

  - `Constructor Injection` (code á»Ÿ trÃªn lÃ  má»™t vÃ­ dá»¥)
  - `Setter Injection`

  **`Car.java`**

  ```java
  public class Car{
      private Engine engine;

      public Car() {};

      // TiÃªm phá»¥ thuá»™c thá»§ cÃ´ng qua Setter
      public void setEngine(Engine engine){
          this.engine = engine;
      }

      void drive(){
          engine.start();
          System.out.println("Car is moving...");
      }
  }
  ```

  **`Main.java`**

  ```java
  @SpringBootApplication
  public class StoreApplication{
      public static void main(String[] args){
          SpringApplication.run(StoreApplication.class, args);

          // Táº¡o Ä‘á»™ng cÆ¡ xÄƒng vÃ  Ä‘á»‘i tÆ°á»£ng Car
          Engine engine = new PetroEngine();
          Car car = new Car();

          // TiÃªm phá»¥ thuá»™c thá»§ cÃ´ng
          car.setEngine(engine);
          car.drive();
      }
  }
  ```

  - `Interface Injection`
    - Má»™t kiá»ƒu `Dependency Injection` Ã­t phá»• biáº¿n hÆ¡n so vá»›i `Constructor Injection` vÃ  `Setter Injection`.
    - NÃ³ hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch táº¡o má»™t interface trung gian Ä‘á»ƒ cung cáº¥p dependency cho lá»›p cáº§n sá»­ dá»¥ng.
