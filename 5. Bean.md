# ğŸŒ± Bean

## **ğŸ”¹ 1. Sping Bean**

- Trong Spring Boot, `Bean` lÃ  má»™t Ä‘á»‘i tÆ°á»£ng do Spring Container quáº£n lÃ½.
- CÃ¡c `Bean` nÃ y thÆ°á»ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong cÃ¡c lá»›p cáº¥u hÃ¬nh hoáº·c Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng thÃ´ng qua Spring Component Scanning

## **ğŸ’¡ 2. CÃ¡ch táº¡o Bean**

**a. DÃ¹ng `@Component`: `@Repository`, `@Service`, `@Controller`**

**b. DÃ¹ng `@Bean` trong class cÃ³ annotation `@Configuration`**

- `@Configuration`

  - LÃ  má»™t annotation Ä‘Ã¡nh dáº¥u trÃªn má»™t class, cho biáº¿t ráº±ng class Ä‘Ã³ chá»©a cÃ¡c thÃ´ng tin cáº¥u hÃ¬nh cho á»©ng dá»¥ng.

  - Spring Boot sáº½ tÃ¬m vÃ  quÃ©t cÃ¡c class Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u `@Configuration` Ä‘á»ƒ táº¡o vÃ  quáº£n lÃ½ cÃ¡c Beans

- `@Bean`

  - LÃ  má»™t annotation Ä‘Ã¡nh dáº¥u trÃªn má»™t method trong class Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u `@Configuration`.

  - NÃ³ cho biáº¿t ráº±ng method Ä‘Ã³ táº¡o vÃ  tráº£ vá» má»™t `Bean` vÃ  Spring Boot nÃªn quáº£n lÃ½ `Bean` Ä‘Ã³ trong á»©ng dá»¥ng

## **ğŸŒ¿ 3. Minh há»a**

- Khi sá»­ dá»¥ng báº±ng `@Configuration` vÃ  `@Bean`, chÃºng ta cáº§n táº¡o má»™t class cáº¥u hÃ¬nh Ä‘á»ƒ khai bÃ¡o vÃ  quáº£n lÃ½ cÃ¡c Ä‘á»‘i tÆ°á»£ng (Bean) thay vÃ¬ new trá»±c tiáº¿p trong mÃ£ nguá»“n.

- DÃ¹ng `@Bean` khi cáº§n kiá»ƒm soÃ¡t viá»‡c táº¡o Bean, Ä‘áº·c biá»‡t vá»›i cÃ¡c thÆ° viá»‡n bÃªn ngoÃ i.

**`AppConfig.java`**

```java
@Configuration
public class AppConfig {

    // DÃ¹ng Ä‘á»ƒ lÆ°u cáº¥u hÃ¬nh cÃ¡c Ä‘á»‘i tÆ°á»£ng (new)
    @Bean
    public Engine engine() {
        return new Engine("V8");
    }
}
```

**`Engine.java`**

```java
public class Engine{
    private String type;

    public Engine(String type){
        this.type = type;
    }

    public String getType(){
        return type;
    }
}
```

**`Car.java`**

```java
@Component
public class Car {
    private Engine engine;

    public Car(Engine engine) {
        this.engine = engine;
    }

    public void showEngine() {
        System.out.println("Loáº¡i Ä‘á»™ng cÆ¡: " + engine.getType());
    }
}
```

**`Main.java`**

```java
@SpringBootApplication
public class StoreApplication {
	public static void main(String[] args) {
		ApplicationContext context = SpringApplication.run(StoreApplication.class, args);
		Car car = context.getBean(Car.class);
		car.showEngine();

        // Káº¿t quáº£: Loáº¡i Ä‘á»™ng cÆ¡: V8
	}
}
```

## **ğŸŒŸ 4. Bean Scope**

### **a. PhÃ¢n loáº¡i**

- **`singleton`** (máº·c Ä‘á»‹nh): Chá»‰ cÃ³ má»™t instance duy nháº¥t trong toÃ n bá»™ Spring Container.

- **`prototype`**: Má»—i láº§n yÃªu cáº§u sáº½ táº¡o má»™t instance má»›i cá»§a Bean.

- **`request`** (Chá»‰ dÃ¹ng trong Web): Má»™t instance má»›i Ä‘Æ°á»£c táº¡o cho má»—i request HTTP.

- **`session`** (Chá»‰ dÃ¹ng trong Web): Má»™t instance Ä‘Æ°á»£c táº¡o cho má»—i session HTTP.

- **`application`** (Chá»‰ dÃ¹ng trong Web): Má»™t instance Ä‘Æ°á»£c táº¡o cho toÃ n bá»™ á»©ng dá»¥ng (dÃ¹ng chung).

### **b. CÃ¡ch táº¡o Bean Scope**

- CÃº phÃ¡p: `@Scope("tÃªn scope")`
- VÃ­ dá»¥:
  - `@Scope("singleton")`

### **c. Minh há»a**

- Äá»‘i vá»›i `@Scope("singleton")`

**`Car.java`**

```java
@Component
@Scope("singleton")
public class Car {
    private Engine engine;

    public Car(Engine engine) {
        this.engine = engine;
    }

    public void showEngine() {
        System.out.println("Loáº¡i Ä‘á»™ng cÆ¡: " + engine.getType());
    }
}
```

**`Main.java`**

```java
@SpringBootApplication
public class StoreApplication {
	public static void main(String[] args) {
		ApplicationContext context = SpringApplication.run(StoreApplication.class, args);
		Car car1 = context.getBean(Car.class);
		System.out.println("CAR1: " + car1);

		Car car2 = context.getBean(Car.class);
		System.out.println("CAR2: " + car2);

        /*
            - 2 Ä‘á»‹a chá»‰ giá»‘ng nhau
                CAR1: com.springmall.store.Car@575c3e9b
                CAR2: com.springmall.store.Car@575c3e9b
        */
	}
}
```

- Äá»‘i vá»›i `@Scope("prototype")`

**`Car.java`**

```java
@Component
@Scope("prototype")
public class Car {
    private Engine engine;

    public Car(Engine engine) {
        this.engine = engine;
    }

    public void showEngine() {
        System.out.println("Loáº¡i Ä‘á»™ng cÆ¡: " + engine.getType());
    }
}
```

**`Main.java`**

```java
@SpringBootApplication
public class StoreApplication {
	public static void main(String[] args) {
		ApplicationContext context = SpringApplication.run(StoreApplication.class, args);
		Car car1 = context.getBean(Car.class);
		System.out.println("CAR1: " + car1);

		Car car2 = context.getBean(Car.class);
		System.out.println("CAR2: " + car2);

        /*
            - 2 Ä‘á»‹a chá»‰ khÃ¡c nhau
                CAR1: com.springmall.store.Car@bc6288b
                CAR2: com.springmall.store.Car@4a3bd45b
        */
	}
}
```
