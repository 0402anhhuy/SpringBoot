# ğŸŒ± Hibernate Custom Validation

## ğŸ¥› KhÃ¡i niá»‡m Hibernate Validation

- Hibernate Validation lÃ  **implement chuáº©n `Bean Validation API` (JSR-380)**

ğŸ“¦ CÃ¡c annotation validation thÃ´ng dá»¥ng

| Annotation          | Ã nghÄ©a                     |
| ------------------- | --------------------------- |
| `@NotNull`          | KhÃ´ng Ä‘Æ°á»£c null             |
| `@NotBlank`         | KhÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng (chuá»—i) |
| `@Size(min=, max=)` | Äá»™ dÃ i chuá»—i                |
| `@Min`, `@Max`      | GiÃ¡ trá»‹ tá»‘i thiá»ƒu/tá»‘i Ä‘a    |
| `@Email`            | Äá»‹nh dáº¡ng email             |

## ğŸª‚KhÃ¡i niá»‡m Custom Validation

> LÃ  **tá»± Ä‘á»‹nh nghÄ©a logic kiá»ƒm tra riÃªng**, khÃ´ng cÃ³ sáºµn trong thÆ° viá»‡n Hibernate

ğŸ“ VÃ­ dá»¥:

- Kiá»ƒm tra username khÃ´ng chá»©a khoáº£ng tráº¯ng
- Kiá»ƒm tra ngÃ y sinh khÃ´ng náº±m trong tÆ°Æ¡ng lai
- Kiá»ƒm tra sá»‘ Ä‘iá»‡n thoáº¡i cÃ³ Ä‘á»‹nh dáº¡ng Viá»‡t Nam

---

## âœ… 3. CÃ¡ch táº¡o custom validation (tá»«ng bÆ°á»›c)

### ğŸ§± BÆ°á»›c 1: Táº¡o annotation

```java
@Documented
@Constraint(validatedBy = NoSpaceValidator.class)
@Target({ ElementType.METHOD, ElementType.FIELD })
@Retention(RetentionPolicy.RUNTIME)
public @interface NoSpace {
    String message() default "KhÃ´ng Ä‘Æ°á»£c chá»©a khoáº£ng tráº¯ng";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}
```

---

### ğŸ§  BÆ°á»›c 2: Táº¡o class xá»­ lÃ½ kiá»ƒm tra (Validator)

```java
public class NoSpaceValidator implements ConstraintValidator<NoSpace, String> {

    @Override
    public void initialize(NoSpace constraintAnnotation) {}

    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        return value != null && !value.contains(" ");
    }
}
```

---

### ğŸ§ª BÆ°á»›c 3: Ãp dá»¥ng vÃ o entity

```java
public class User {

    @NoSpace
    private String username;

    @Email
    private String email;
}
```

---

### âœ… BÆ°á»›c 4: Káº¿t há»£p vá»›i `@Valid` trong controller

```java
@PostMapping("/register")
public String register(@Valid @ModelAttribute User user, BindingResult result) {
    if (result.hasErrors()) {
        return "form";
    }
    return "success";
}
```

ğŸ“Œ `@Valid` sáº½ kick hoáº¡t cÃ¡c validation (bao gá»“m custom)
ğŸ“Œ `BindingResult` sáº½ chá»©a lá»—i náº¿u cÃ³

---

## âœ… Æ¯u Ä‘iá»ƒm cá»§a Custom Validation

| Æ¯u Ä‘iá»ƒm                                             | âœ”   |
| --------------------------------------------------- | --- |
| Äá»‹nh nghÄ©a logic riÃªng                              | âœ…  |
| Dá»… dÃ¹ng láº¡i, tÃ¡ch biá»‡t                              | âœ…  |
| Káº¿t há»£p tá»‘t vá»›i JPA entity                          | âœ…  |
| TÆ°Æ¡ng thÃ­ch hoÃ n toÃ n vá»›i `@Valid` vÃ  `Spring Boot` | âœ…  |

---

## âœ… Tá»•ng káº¿t

| ThÃ nh pháº§n                             | Vai trÃ²                      |
| -------------------------------------- | ---------------------------- |
| Annotation `@YourCustom`               | Gáº¯n vÃ o field                |
| Class `implements ConstraintValidator` | Chá»©a logic validate          |
| `@Valid`                               | Kick hoáº¡t kiá»ƒm tra           |
| `BindingResult`                        | Nháº­n lá»—i Ä‘á»ƒ hiá»ƒn thá»‹ ra view |

---

ğŸ“Œ Muá»‘n mÃ¬nh táº¡o luÃ´n 1 demo thá»±c táº¿:

- Form nháº­p `username`
- Custom validator kiá»ƒm tra khÃ´ng chá»©a sá»‘, khÃ´ng chá»©a space
- Giao diá»‡n thÃ´ng bÃ¡o lá»—i rÃµ rÃ ng

ğŸ‘‰ Báº¡n chá»‰ cáº§n nÃ³i: â€œDemo custom validationâ€, mÃ¬nh build luÃ´n HTML + controller + validator nhÃ© ğŸ”§ğŸ¤–
