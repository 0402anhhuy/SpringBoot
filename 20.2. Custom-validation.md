# ğŸŒ± Hibernate Custom Validation

## ğŸ¥› KhÃ¡i niá»‡m Hibernate Validation

- Hibernate Validation lÃ  **implement chuáº©n `Bean Validation API` (JSR-380)**

ğŸ“¦ CÃ¡c annotation validation thÃ´ng dá»¥ng

| Annotation          | Ã nghÄ©a                     |
| ------------------- | --------------------------- |
| `@NotNull`          | KhÃ´ng Ä‘Æ°á»£c null             |
| `@NotBlank`         | KhÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng (chuá»—i) |
| `@Size(min=, max=)` | Äá»™ dÃ i chuá»—i                |
| `@Min`, `@Max`      | GiÃ¡ trá»‹ tá»‘i thiá»ƒu/tá»‘i Ä‘a    |
| `@Email`            | Äá»‹nh dáº¡ng email             |

## ğŸª‚KhÃ¡i niá»‡m Custom Validation

> LÃ  **tá»± Ä‘á»‹nh nghÄ©a logic kiá»ƒm tra riÃªng**, khÃ´ng cÃ³ sáºµn trong thÆ° viá»‡n Hibernate

### ğŸ“ VÃ­ dá»¥

- Kiá»ƒm tra username khÃ´ng chá»©a khoáº£ng tráº¯ng
- Kiá»ƒm tra ngÃ y sinh khÃ´ng náº±m trong tÆ°Æ¡ng lai
- Kiá»ƒm tra sá»‘ Ä‘iá»‡n thoáº¡i cÃ³ Ä‘á»‹nh dáº¡ng Viá»‡t Nam (09xxxxxxxx)

## ğŸ›¹ CÃ¡ch táº¡o custom validation

### ğŸ§± BÆ°á»›c 1: Táº¡o annotation

```java
@Documented
@Constraint(validatedBy = NoSpaceValidator.class)
@Target({ ElementType.METHOD, ElementType.FIELD })
@Retention(RetentionPolicy.RUNTIME)
public @interface NoSpace {
    String message() default "KhÃ´ng Ä‘Æ°á»£c chá»©a khoáº£ng tráº¯ng";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}
```

### ğŸš¡ BÆ°á»›c 2: Táº¡o class xá»­ lÃ½ kiá»ƒm tra (Validator)

```java
public class NoSpaceValidator implements ConstraintValidator<NoSpace, String> {

    @Override
    public void initialize(NoSpace constraintAnnotation) {}

    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        return value != null && !value.contains(" ");
    }
}
```

### ğŸ§ª BÆ°á»›c 3: Ãp dá»¥ng vÃ o entity

```java
public class User {

    @NoSpace
    private String username;

    @Email
    private String email;
}
```

### ğŸŒŒ BÆ°á»›c 4: Káº¿t há»£p vá»›i `@Valid` trong controller

```java
@PostMapping("/register")
public String register(@Valid @ModelAttribute User user, BindingResult result) {
    if (result.hasErrors()) {
        return "form";
    }
    return "success";
}
```

- `@Valid` sáº½ kick hoáº¡t cÃ¡c validation (bao gá»“m custom)
- `BindingResult` sáº½ chá»©a lá»—i náº¿u cÃ³
