# üå± Derived Query Method

## ü•† Kh√°i ni·ªám

- L√† ph∆∞∆°ng th·ª©c **t·ª± ƒë·ªông t·∫°o truy v·∫•n SQL ch·ªâ b·∫±ng t√™n h√†m** trong `Repository`

- Spring s·∫Ω **ph√¢n t√≠ch t√™n h√†m ‚Üí sinh ra SQL t∆∞∆°ng ·ª©ng** (Kh√¥ng c·∫ßn vi·∫øt SQL ho·∫∑c JPQL th·ªß c√¥ng)

- Vi·∫øt t√™n h√†m ƒë√∫ng c√∫ ph√°p ‚Üí s·ª≠ d·ª•ng ƒë∆∞·ª£c lu√¥n

## üç† C√°ch ho·∫°t ƒë·ªông

### üîé V√≠ d·ª•

- T·∫°o **Entity** `Product` v·ªõi c√°c tr∆∞·ªùng `id`, `name`, `price`

**`Product.java`**

```java
@Entity
public class Product {
    @Id
    private Long id;

    private String name;
    private Double price;
}
```

- T·∫°o **Repository** `ProductRepository` k·∫ø th·ª´a `JpaRepository`

**`ProductRepository.java`**

```java
public interface ProductRepository extends JpaRepository<Product, Long> {
    List<Product> findByNameContaining(String keyword);
    Product findByIdAndName(Long id, String name);
}
```

## ‚ú® Gi·∫£i th√≠ch

### üßß `List<Product> findByNameContaining(String keyword)`

| Th√†nh ph·∫ßn       | √ù nghƒ©a                    |
| ---------------- | -------------------------- |
| `findBy`         | ƒê√¢y l√† 1 truy v·∫•n          |
| `Name`           | T√™n c·ªßa field trong entity |
| `Containing`     | T√¨m theo LIKE `%keyword%`  |
| `String keyword` | Tham s·ªë truy·ªÅn v√†o         |

ü•é Truy v·∫•n SQL t∆∞∆°ng ·ª©ng

```sql
SELECT * FROM product WHERE name LIKE '%keyword%'
```

### üé® `Product findByIdAndName(Long id, String name)`

| Th√†nh ph·∫ßn  | √ù nghƒ©a                   |
| ----------- | ------------------------- |
| `findBy`    | Truy v·∫•n                  |
| `IdAndName` | WHERE id = ? AND name = ? |

üèà Truy v·∫•n SQL t∆∞∆°ng ·ª©ng

```sql
SELECT * FROM product WHERE id = ? AND name = ?
```

## üé≥ Method v√† t·ª´ kh√≥a th∆∞·ªùng d√πng trong Derived Query

### üèπ Methods

| Method    | √ù nghƒ©a |
| --------- | ------- |
| `findBy`  | T√¨m     |
| `readBy`  | T√¨m     |
| `getBy`   | T√¨m     |
| `queryBy` | T√¨m     |

### üéá T·ª´ kh√≥a

| T·ª´ kh√≥a                      | SQL                      |
| ---------------------------- | ------------------------ |
| `And`, `Or`                  | `AND`, `OR`              |
| `Is`, `Equals`               | `=`                      |
| `Between`                    | BETWEEN                  |
| `LessThan`, `GreaterThan`    | `<`, `>`                 |
| `Like`, `Containing`         | `LIKE`, `%...%`          |
| `StartingWith`, `EndingWith` | `LIKE 'xxx%'`, `'xxx'`   |
| `In`, `NotIn`                | `IN (...)`               |
| `IsNull`, `IsNotNull`        | `IS NULL`, `IS NOT NULL` |

## üé≤ V√≠ d·ª•

```java
// L·∫•y t·∫•t c·∫£ product c√≥ gi√° nh·ªè h∆°n 500
List<Product> findByPriceLessThan(Double price);

// T√¨m theo t√™n v√† gi√°
Product findByNameAndPrice(String name, Double price);

// L·∫•y s·∫£n ph·∫©m c√≥ t√™n b·∫Øt ƒë·∫ßu b·∫±ng ‚ÄúiPhone‚Äù
List<Product> findByNameStartingWith(String prefix);

// T√¨m theo danh s√°ch ID
List<Product> findByIdIn(List<Long> ids);
```

## ‚ö†Ô∏è 6. Quy t·∫Øc ƒë·∫∑t t√™n

| Quy t·∫Øc                         | V√≠ d·ª•                                                                                 |
| ------------------------------- | ------------------------------------------------------------------------------------- |
| T√™n ph·∫£i **ƒë√∫ng v·ªõi t√™n field** | N·∫øu entity l√† `Product` c√≥ `name`, `price`, th√¨ `findByPrice`, `findByName` l√† h·ª£p l·ªá |
| Ph√¢n bi·ªát **camelCase**         | `findByProductName` ‚â† `findByproductname`                                             |
| Sai t√™n field = ‚ùå l·ªói runtime  | V√¨ JPA kh√¥ng t√¨m th·∫•y column t∆∞∆°ng ·ª©ng                                                |
