# ğŸŒ± Derived Query Method

## ğŸ¥  KhÃ¡i niá»‡m

- LÃ  phÆ°Æ¡ng thá»©c **tá»± Ä‘á»™ng táº¡o truy váº¥n SQL chá»‰ báº±ng tÃªn hÃ m** trong `Repository`

- Spring sáº½ **phÃ¢n tÃ­ch tÃªn hÃ m â†’ sinh ra SQL tÆ°Æ¡ng á»©ng** (KhÃ´ng cáº§n viáº¿t SQL hoáº·c JPQL thá»§ cÃ´ng)

- Viáº¿t tÃªn hÃ m Ä‘Ãºng cÃº phÃ¡p â†’ sá»­ dá»¥ng Ä‘Æ°á»£c luÃ´n

## ğŸ  CÃ¡ch hoáº¡t Ä‘á»™ng

### ğŸ” VÃ­ dá»¥

- Táº¡o **Entity** `Product` vá»›i cÃ¡c trÆ°á»ng `id`, `name`, `price`

**`Product.java`**

```java
@Entity
public class Product {
    @Id
    private Long id;

    private String name;
    private Double price;
}
```

- Táº¡o **Repository** `ProductRepository` káº¿ thá»«a `JpaRepository`

**`ProductRepository.java`**

```java
public interface ProductRepository extends JpaRepository<Product, Long> {
    List<Product> findByNameContaining(String keyword);
    Product findByIdAndName(Long id, String name);
}
```

## âœ¨ Giáº£i thÃ­ch

### ğŸ§§ `List<Product> findByNameContaining(String keyword)`

| ThÃ nh pháº§n       | Ã nghÄ©a                    |
| ---------------- | -------------------------- |
| `findBy`         | ÄÃ¢y lÃ  1 truy váº¥n          |
| `Name`           | TÃªn cá»§a field trong entity |
| `Containing`     | TÃ¬m theo LIKE `%keyword%`  |
| `String keyword` | Tham sá»‘ truyá»n vÃ o         |

ğŸ¥ Spring Boot táº¡o cÃ¢u truy váº¥n SQL

```sql
SELECT * FROM product WHERE name LIKE '%keyword%'
```

### ğŸ¨ `Product findByIdAndName(Long id, String name)`

| ThÃ nh pháº§n  | Ã nghÄ©a                   |
| ----------- | ------------------------- |
| `findBy`    | Truy váº¥n                  |
| `IdAndName` | WHERE id = ? AND name = ? |

ğŸˆ SQL tÆ°Æ¡ng á»©ng:

```sql
SELECT * FROM product WHERE id = ? AND name = ?
```

## ğŸ§  4. CÃ¡c keyword thÆ°á»ng dÃ¹ng

| TÃªn method | Ã nghÄ©a  |
| ---------- | -------- |
| `findBy`   | TÃ¬m      |
| `readBy`   | TÆ°Æ¡ng tá»± |
| `getBy`    | TÆ°Æ¡ng tá»± |

| Tá»« khÃ³a                      | SQL                      |
| ---------------------------- | ------------------------ |
| `And`, `Or`                  | `AND`, `OR`              |
| `Is`, `Equals`               | `=`                      |
| `Between`                    | BETWEEN                  |
| `LessThan`, `GreaterThan`    | `<`, `>`                 |
| `Like`, `Containing`         | `LIKE`, `%...%`          |
| `StartingWith`, `EndingWith` | `LIKE 'xxx%'`, `'xxx'`   |
| `In`, `NotIn`                | `IN (...)`               |
| `IsNull`, `IsNotNull`        | `IS NULL`, `IS NOT NULL` |

---

## âœ… 5. VÃ­ dá»¥ thá»±c táº¿

```java
// Láº¥y táº¥t cáº£ product cÃ³ giÃ¡ nhá» hÆ¡n 500
List<Product> findByPriceLessThan(Double price);

// TÃ¬m theo tÃªn vÃ  giÃ¡
Product findByNameAndPrice(String name, Double price);

// Láº¥y sáº£n pháº©m cÃ³ tÃªn báº¯t Ä‘áº§u báº±ng â€œiPhoneâ€
List<Product> findByNameStartingWith(String prefix);

// TÃ¬m theo danh sÃ¡ch ID
List<Product> findByIdIn(List<Long> ids);
```

---

## âš ï¸ 6. Quy táº¯c Ä‘áº·t tÃªn

| Quy táº¯c                         | VÃ­ dá»¥                                                                                 |
| ------------------------------- | ------------------------------------------------------------------------------------- |
| TÃªn pháº£i **Ä‘Ãºng vá»›i tÃªn field** | Náº¿u entity lÃ  `Product` cÃ³ `name`, `price`, thÃ¬ `findByPrice`, `findByName` lÃ  há»£p lá»‡ |
| PhÃ¢n biá»‡t **camelCase**         | `findByProductName` â‰  `findByproductname`                                             |
| Sai tÃªn field = âŒ lá»—i runtime  | VÃ¬ JPA khÃ´ng tÃ¬m tháº¥y column tÆ°Æ¡ng á»©ng                                                |

---

## âœ… 7. TÃ³m láº¡i

| Æ¯u Ä‘iá»ƒm                            | âœ… CÃ³ |
| ---------------------------------- | ----- |
| KhÃ´ng cáº§n viáº¿t SQL                 | âœ”ï¸    |
| Tá»± Ä‘á»™ng sinh truy váº¥n              | âœ”ï¸    |
| Gá»n, dá»… dÃ¹ng vá»›i project nhá» & vá»«a | âœ”ï¸    |
| Dá»… Ä‘á»c, dá»… hiá»ƒu                    | âœ”ï¸    |

| Háº¡n cháº¿               | âŒ                          |
| --------------------- | --------------------------- |
| Truy váº¥n quÃ¡ phá»©c táº¡p | NÃªn dÃ¹ng `@Query`           |
| TÃªn hÃ m dÃ i, rá»‘i      | NÃªn tÃ¡ch nhá» / custom query |

---

ğŸ“Œ Báº¡n muá»‘n mÃ¬nh táº¡o 1 file `ProductRepository` vá»›i 10 method thá»±c chiáº¿n?
Hay build demo â€œTÃ¬m kiáº¿m sáº£n pháº©m theo tÃªn vÃ  khoáº£ng giÃ¡â€?

ğŸ‘‰ Chá»‰ cáº§n nÃ³i â€œDemo tÃ¬m kiáº¿m nÃ¢ng cao JPAâ€, mÃ¬nh code liá»n ğŸ”§ğŸ¤–
