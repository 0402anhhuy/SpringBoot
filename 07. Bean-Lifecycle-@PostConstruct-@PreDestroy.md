# ğŸŒ± Bean Lifecycle

## **ğŸ“Œ VÃ²ng Ä‘á»i cá»§a Bean**

- **Táº¡o Ä‘á»‘i tÆ°á»£ng (Instantiation)** â†’ Spring táº¡o má»™t instance cá»§a Bean.

- **TiÃªm phá»¥ thuá»™c (Dependency Injection)** â†’ Spring tiÃªm cÃ¡c dependencies vÃ o Bean.

- **Sau khi khá»Ÿi táº¡o (Post-Initialization)** â†’ Gá»i cÃ¡c phÆ°Æ¡ng thá»©c tÃ¹y chá»‰nh sau khi Bean Ä‘Æ°á»£c táº¡o.

- **Sá»­ dá»¥ng Bean (Usage)** â†’ Bean Ä‘Æ°á»£c sá»­ dá»¥ng trong á»©ng dá»¥ng.

- **TrÆ°á»›c khi há»§y (Pre-Destruction)** â†’ Gá»i cÃ¡c phÆ°Æ¡ng thá»©c dá»n dáº¹p trÆ°á»›c khi Bean bá»‹ há»§y.

- **Há»§y Bean (Destruction)** â†’ Spring xÃ³a Bean khá»i bá»™ nhá»›.

ğŸ“Œ **`@Scope("singleton")`** â†’ Spring quáº£n lÃ½ toÃ n bá»™ vÃ²ng Ä‘á»i cá»§a Bean.

ğŸ“Œ **`@Scope("prototype")`** â†’ Spring chá»‰ quáº£n lÃ½ viá»‡c **táº¡o vÃ  tiÃªm dependencies**, khÃ´ng quáº£n lÃ½ viá»‡c há»§y.

## **ğŸ”¹ Triá»ƒn khai cÃ¡c phÆ°Æ¡ng thá»©c vÃ²ng Ä‘á»i**

- Sá»­ dá»¥ng **`@PostConstruct`** vÃ  **`@PreDestroy`**

- VÃ­ dá»¥:

**`Car.java`**

```java
@Component
public class Car{

    public Car(){
        System.out.println("ğŸš— Car Bean Ä‘Æ°á»£c táº¡o!");
    }

    @PostConstruct
    public void init(){
        System.out.println("ğŸ”§ Car Bean Ä‘Ã£ khá»Ÿi táº¡o!");
    }

    @PreDestroy
    public void destroy(){
        System.out.println("ğŸ’¥ Car Bean bá»‹ há»§y!");
    }
}
```

- Káº¿t quáº£:

  ğŸš— Car Bean Ä‘Æ°á»£c táº¡o!  
   ğŸ”§ Car Bean Ä‘Ã£ khá»Ÿi táº¡o!  
   ğŸ’¥ Car Bean bá»‹ há»§y!

## **ğŸ˜Š Giáº£i thÃ­ch vÃ²ng Ä‘á»i Bean**

**`Car.java`**

```java
@Component
public class Car{

    public Car(){
        System.out.println("ğŸš— Car Bean Ä‘Æ°á»£c táº¡o!");
    }

    @PostConstruct
    public void init(){
        System.out.println("ğŸ”§ Car Bean Ä‘Ã£ khá»Ÿi táº¡o!");
    }

    @PreDestroy
    public void destroy(){
        System.out.println("ğŸ’¥ Car Bean bá»‹ há»§y!");
    }

    public void showEngine(){
        System.out.println("Äá»™ng cÆ¡ Ä‘Æ°á»£c khá»Ÿi táº¡o");
    }
}
```

**`Main.java`**

```java
@SpringBootApplication
public class StoreApplication {
	public static void main(String[] args) {
		ApplicationContext context = SpringApplication.run(StoreApplication.class, args);
		Car car1 = context.getBean(Car.class);
		car1.showEngine();
	}
}
```

### **1ï¸âƒ£ Khá»Ÿi Äá»™ng Spring Boot**

- Lá»‡nh **`SpringApplication.run(StoreApplication.class, args)`** sáº½:
  - Táº¡o vÃ  cáº¥u hÃ¬nh ApplicationContext (Spring Container).
  - QuÃ©t vÃ  tÃ¬m kiáº¿m cÃ¡c Bean (Component Scanning).
  - Khá»Ÿi táº¡o vÃ  quáº£n lÃ½ Bean.

ğŸ“Œ Káº¿t quáº£ trÃªn console (log khi khá»Ÿi Ä‘á»™ng Spring Boot):

```sql
 :: Spring Boot ::                (vX.X.X)
...
INFO  main --- Starting StoreApplication using Java X.X
INFO  main --- No active profile set, falling back to default profiles: default
INFO  main --- Started StoreApplication in X.XXX seconds
```

### **2ï¸âƒ£ Táº¡o ApplicationContext vÃ  QuÃ©t Bean**

- Spring Boot sá»­ dá»¥ng `Component Scanning` Ä‘á»ƒ tÃ¬m táº¥t cáº£ cÃ¡c Bean bÃªn trong package chá»©a **`@SpringBootApplication`**.

### **3ï¸âƒ£ Inject Bean (Dependency Injection)**

- Spring inject **Engine** vÃ o **Car** thÃ´ng qua constructor (**`@Autowired`**).

- VÃ¬ **Car** lÃ  **singleton**, nÃ³ sáº½ chá»‰ Ä‘Æ°á»£c táº¡o má»™t láº§n vÃ  lÆ°u trong **`ApplicationContext`**.

### **4ï¸âƒ£ Tráº£ Vá» ApplicationContext**

- Sau khi khá»Ÿi táº¡o táº¥t cáº£ cÃ¡c **`Bean`**, **`SpringApplication.run(StoreApplication.class, args)`**
- Tráº£ vá» má»™t ApplicationContext Ä‘á»ƒ á»©ng dá»¥ng cÃ³ thá»ƒ láº¥y Bean tá»« Ä‘Ã³.

### **5ï¸âƒ£ Sá»­ Dá»¥ng Bean**

- LÃºc nÃ y, Car car1 Ä‘Ã£ Ä‘Æ°á»£c láº¥y tá»« `Spring Container` vÃ  cÃ³ thá»ƒ sá»­ dá»¥ng.

### **6ï¸âƒ£ Táº¯t á»¨ng Dá»¥ng - Há»§y Bean (Destruction)**

- `Car` cÃ³ phÆ°Æ¡ng thá»©c há»§y **`@PreDestroy`**, Spring sáº½ gá»i trÆ°á»›c khi Ä‘Ã³ng á»©ng dá»¥ng.

## **ğŸ”„ TÃ³m táº¯t vÃ²ng Ä‘á»i cá»§a Bean**

| **Giai Ä‘oáº¡n**        | **Ghi chÃº**               | **Káº¿t quáº£ console**      |
| -------------------- | ------------------------- | ------------------------ |
| **1ï¸âƒ£ Táº¡o Bean**      | Constructor cháº¡y          | ğŸš— Car Bean Ä‘Æ°á»£c táº¡o!    |
| **2ï¸âƒ£ Khá»Ÿi táº¡o Bean** | **`@PostConstruct`** cháº¡y | ğŸ”§ Car Bean Ä‘Ã£ khá»Ÿi táº¡o! |
| **3ï¸âƒ£ Sá»­ dá»¥ng Bean**  | Gá»i phÆ°Æ¡ng thá»©c           | Äá»™ng cÆ¡ Ä‘Æ°á»£c khá»Ÿi táº¡o    |
| **4ï¸âƒ£ Há»§y Bean**      | **`@PreDestroy`** cháº¡y    | ğŸ’¥ Car Bean bá»‹ há»§y!      |
