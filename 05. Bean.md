# üå± Bean

## **üîπ 1. Sping Bean**

- Trong Spring Boot, `Bean` l√† m·ªôt ƒë·ªëi t∆∞·ª£ng do Spring Container qu·∫£n l√Ω

- C√°c `Bean` n√†y th∆∞·ªùng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong c√°c l·ªõp c·∫•u h√¨nh ho·∫∑c ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông th√¥ng qua Spring Component Scanning

## **üí° 2. C√°ch t·∫°o Bean**

**a. D√πng `@Component`: `@Repository`, `@Service`, `@Controller`**

**b. D√πng `@Bean` trong class c√≥ annotation `@Configuration`**

- `@Configuration`

  - L√† m·ªôt annotation ƒë√°nh d·∫•u tr√™n m·ªôt class, cho bi·∫øt r·∫±ng class ƒë√≥ ch·ª©a c√°c th√¥ng tin c·∫•u h√¨nh cho ·ª©ng d·ª•ng

  - Spring Boot s·∫Ω t√¨m v√† qu√©t c√°c class ƒë∆∞·ª£c ƒë√°nh d·∫•u `@Configuration` ƒë·ªÉ t·∫°o v√† qu·∫£n l√Ω c√°c Beans

- `@Bean`

  - L√† m·ªôt annotation ƒë√°nh d·∫•u tr√™n m·ªôt method trong class ƒë∆∞·ª£c ƒë√°nh d·∫•u `@Configuration`

  - N√≥ cho bi·∫øt r·∫±ng method ƒë√≥ t·∫°o v√† tr·∫£ v·ªÅ m·ªôt `Bean` v√† Spring Boot n√™n qu·∫£n l√Ω `Bean` ƒë√≥ trong ·ª©ng d·ª•ng

## **üåø 3. Minh h·ªça**

- Khi s·ª≠ d·ª•ng b·∫±ng `@Configuration` v√† `@Bean`, ch√∫ng ta c·∫ßn t·∫°o m·ªôt class c·∫•u h√¨nh ƒë·ªÉ khai b√°o v√† qu·∫£n l√Ω c√°c ƒë·ªëi t∆∞·ª£ng (Bean) thay v√¨ new tr·ª±c ti·∫øp trong m√£ ngu·ªìn

- D√πng `@Bean` khi c·∫ßn ki·ªÉm so√°t vi·ªác t·∫°o Bean, ƒë·∫∑c bi·ªát v·ªõi c√°c th∆∞ vi·ªán b√™n ngo√†i

**`AppConfig.java`**

```java
@Configuration
public class AppConfig {

    // D√πng ƒë·ªÉ l∆∞u c·∫•u h√¨nh c√°c ƒë·ªëi t∆∞·ª£ng (new)
    @Bean
    public Engine engine() {
        return new Engine("V8");
    }
}
```

**`Engine.java`**

```java
public class Engine{
    private String type;

    public Engine(String type){
        this.type = type;
    }

    public String getType(){
        return type;
    }
}
```

**`Car.java`**

```java
@Component
public class Car {
    private Engine engine;

    public Car(Engine engine) {
        this.engine = engine;
    }

    public void showEngine() {
        System.out.println("Lo·∫°i ƒë·ªông c∆°: " + engine.getType());
    }
}
```

**`Main.java`**

```java
@SpringBootApplication
public class StoreApplication {
	public static void main(String[] args) {
		ApplicationContext context = SpringApplication.run(StoreApplication.class, args);
		Car car = context.getBean(Car.class);
		car.showEngine();
	}
}
```

> K·∫øt qu·∫£: Lo·∫°i ƒë·ªông c∆°: V8

## **üåü 4. Bean Scope**

### **a. Ph√¢n lo·∫°i**

- **`singleton`** (m·∫∑c ƒë·ªãnh): Ch·ªâ c√≥ m·ªôt instance duy nh·∫•t trong to√†n b·ªô Spring Container

- **`prototype`**: M·ªói l·∫ßn y√™u c·∫ßu s·∫Ω t·∫°o m·ªôt instance m·ªõi c·ªßa Bean

- **`request`** (Ch·ªâ d√πng trong Web): M·ªôt instance m·ªõi ƒë∆∞·ª£c t·∫°o cho m·ªói request HTTP

- **`session`** (Ch·ªâ d√πng trong Web): M·ªôt instance ƒë∆∞·ª£c t·∫°o cho m·ªói session HTTP

- **`application`** (Ch·ªâ d√πng trong Web): M·ªôt instance ƒë∆∞·ª£c t·∫°o cho to√†n b·ªô ·ª©ng d·ª•ng (d√πng chung)

### **b. C√°ch t·∫°o Bean Scope**

- C√∫ ph√°p: `@Scope("t√™n scope")`
- V√≠ d·ª•:
  - `@Scope("singleton")`

### **c. Minh h·ªça**

- ƒê·ªëi v·ªõi `@Scope("singleton")`

**`Car.java`**

```java
@Component
@Scope("singleton")
public class Car {
    private Engine engine;

    public Car(Engine engine) {
        this.engine = engine;
    }

    public void showEngine() {
        System.out.println("Lo·∫°i ƒë·ªông c∆°: " + engine.getType());
    }
}
```

**`Main.java`**

```java
@SpringBootApplication
public class StoreApplication {
	public static void main(String[] args) {
		ApplicationContext context = SpringApplication.run(StoreApplication.class, args);
		Car car1 = context.getBean(Car.class);
		System.out.println("CAR1: " + car1);

		Car car2 = context.getBean(Car.class);
		System.out.println("CAR2: " + car2);
	}
}
```

> CAR1: com.springmall.store.Car@575c3e9b  
> CAR2: com.springmall.store.Car@575c3e9b

- ƒê·ªëi v·ªõi `@Scope("prototype")`

**`Car.java`**

```java
@Component
@Scope("prototype")
public class Car {
    private Engine engine;

    public Car(Engine engine) {
        this.engine = engine;
    }

    public void showEngine() {
        System.out.println("Lo·∫°i ƒë·ªông c∆°: " + engine.getType());
    }
}
```

**`Main.java`**

```java
@SpringBootApplication
public class StoreApplication {
	public static void main(String[] args) {
		ApplicationContext context = SpringApplication.run(StoreApplication.class, args);
		Car car1 = context.getBean(Car.class);
		System.out.println("CAR1: " + car1);

		Car car2 = context.getBean(Car.class);
		System.out.println("CAR2: " + car2);

        /*
            - 2 ƒë·ªãa ch·ªâ kh√°c nhau
                CAR1: com.springmall.store.Car@bc6288b
                CAR2: com.springmall.store.Car@4a3bd45b
        */
	}
}
```
