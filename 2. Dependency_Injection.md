# 🌱 Dependency Injection (DI) trong Spring Boot  

**Dependency Injection (DI)** là một kỹ thuật trong lập trình giúp giảm sự phụ thuộc giữa các thành phần trong ứng dụng, làm cho mã dễ bảo trì và mở rộng hơn, để hiểu rõ được cách hoạt động của DI thì chúng ta cần tìm hiểu hai khái niệm dưới đây.

---

## 🔗 Tight Coupling (Ràng buộc chặt chẽ)  
- Xảy ra khi một class phụ thuộc mạnh vào một class khác, làm giảm tính linh hoạt và khó thay đổi.
- Khi yêu cầu thay đổi logic hay một Class bị lỗi sẽ dẫn tới ảnh hưởng tới toàn bộ các Class khác.

### 🔹 Ví dụ về Tight Coupling:  
```java
class Engine{
    void start(){
        System.out.println("Engine is starting...");
    }
}

class Car{
    private Engine engine = new Engine(); // Ràng buộc chặt chẽ

    void drive(){
        engine.start();
        System.out.println("Car is moving...");
    }
}

class Truck{
    private Engine engine = new Engine(); // Ràng buộc chặt chẽ

    void drive(){
        engine.start();
        System.out.println("Truck is moving...");
    }
}
```
### **💡 Vấn đề Tight Coupling nằm ở đâu?**
**1️⃣ Car, Truck tự tạo ra một object Engine bằng cách new Engine()**

- Điều này có nghĩa là Car, Truck phụ thuộc trực tiếp vào Engine.

- Nếu chúng ta muốn thay đổi động cơ (ví dụ DieselEngine, ElectricEngine), chúng ta phải sửa code trong Car và Truck.

**2️⃣ Khó mở rộng hoặc thay đổi sau này**

- Nếu ta có một loại động cơ mới, ta phải sửa class Car, Truck để thay thế Engine.

- Điều này làm giảm tính linh hoạt, vì mỗi khi có thay đổi, ta phải sửa code trong nhiều nơi làm cho code trở nên phức tạp hơn.


## 🔗 Loose Coupling (Ràng buộc lỏng lẻo)
- Giúp tách biệt các thành phần, làm cho hệ thống dễ dàng bảo trì và mở rộng bằng cách sử dụng Dependency Injection.

### 🔹 Ví dụ về Loose Coupling: 
```java
public interface Engine{
    void start();
}

public class PetrolEngine implements Engine{
    @Override
    public void start(){
        System.out.println("Petrol Engine is starting...");
    }
}

public class DieselEngine implements Engine{
    @Override
    public void start(){
        System.out.println("Diesel Engine is starting...");
    }
}

public class Car{
    private Engine engine;

    // Inject Engine vào Car thông qua constructor
    public Car(Engine engine){
        this.engine = engine;
    }

    void drive(){
        engine.start();
        System.out.println("Car is moving...");
    }
}

public class Main{
    public static void main(String[] args){

        // Tạo động cơ xăng
        Engine petrolEngine = new PetrolEngine();

        // Inject PetrolEngine vào Car
        Car myCar = new Car(petrolEngine);        
        myCar.drive(); 
        // Kết quả: Petrol Engine is starting... Car is moving...

        // Tạo động cơ dầu
        Engine dieselEngine = new DieselEngine();

        // Inject DieselEngine vào Car
        Car anotherCar = new Car(dieselEngine);    
        anotherCar.drive(); 
        // Kết quả: Diesel Engine is starting... Car is moving...
    }
}
```
📌 Ở đây, Car không còn phụ thuộc trực tiếp vào PetrolEngine hay DieselEngine, mà chỉ phụ thuộc vào interface Engine. Điều này giúp dễ dàng thay đổi loại động cơ mà không ảnh hưởng đến lớp Car.

---
## 🔗 Dependency Injection (DI)
- Trong DI, các phụ thuộc của một đối tượng không được tạo bên trong đối tượng đó, mà được cung cấp từ bên ngoài.

- DI thường được thực hiện thông qua:
    - Constructor Injection (code ở trên là 1 ví dụ)
    - Setter Injection
    ```java
    public class Car{
        private Engine engine;

        // Ở đây thì mình sẽ tiêm sự phụ thuộc và phương thức setter
        public void setEngine(Engine engine){
            this.engine = engine;
        }

        void drive(){
            engine.start();
            System.out.println("Car is moving...");
        }
    }
    public class Main{
        public static void main(String[] args){
            Engine petroEngine = new PetroEngine();
            Engine dieselEngine = new DieselEngine();
            
            // Sự khác biệt ở đây là không cần phải khởi tạo Engine ban đầu (Trong trường hợp là bắt buộc có thì Constructor Injection sẽ phù hợp)
            Car car = new Car();
            car.setEngine(petroEngine);
            car.drive();

            car.setEngine(dieselEngine);
            car.drive();
        }
    }
    ```
    - Interface Injection
        - Một kiểu Dependency Injection ít phổ biến hơn so với Constructor Injection và Setter Injection.
        - Nó hoạt động bằng cách tạo một interface trung gian để cung cấp dependency cho lớp cần sử dụng.